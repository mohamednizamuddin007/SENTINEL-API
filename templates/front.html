<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Scan Results</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="dashboard-bg">
  <div class="dashboard-container">
    <h1 class="subtitle"> üõ°Ô∏è SENTINEL API - URL Safety Analysis</h1>

    {% if data %}
    <div class="status-bar 
      {% if data.malicious > 50 %}red
      {% elif data.malicious > 20 %}blue
      {% else %}green{% endif %}">
      {{ data.url }} ‚Üí
      {% if data.malicious > 50 %}
      <br>
        üö® Malicious: {{ data.malicious }}%
      {% elif data.malicious > 20 %}
      <br>
        ‚ö†Ô∏è Possibly Unsafe: {{ data.malicious }}%
      {% else %}
      <br>
        ‚úÖ Safe: {{ data.safe }}%
      {% endif %}
    </div>

    <div class="charts-container">
      <div class="chart-box">
        <canvas id="scanChart" width="260" height="260"></canvas>
        <div class="legend">URL Safety Breakdown</div>
      </div>
    </div>

    <script>
      const ctx = document.getElementById('scanChart').getContext('2d');
      const safe = {{ data.safe }};
      const malicious = {{ data.malicious }};

      new Chart(ctx, {
        type: 'pie',
        data: {
          labels: ['Safe', 'Malicious'],
          datasets: [{
            data: [safe, malicious],
            backgroundColor: ['#22c55e', '#ef4444'],
            borderWidth: 0
          }]
        },
        options: {
          cutout: '0%',
          plugins: {
            legend: {
              labels: { color: 'white' }
            }
          }
        }
      });
    </script>
    {% else %}
      <p class="subtitle">No data found. Please go back and scan a URL.</p>
    {% endif %}
  </div>
</body>
</html>
